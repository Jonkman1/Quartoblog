{
  "hash": "917c4e0a44be9e8ec60ac4240c3afea4",
  "result": {
    "markdown": "---\ntitle: \"Revenue and expenditure in sport\"\nauthor: \"Alex Trinidad\"\ndate: \"2022-04-22\"\ncategories: [exploration, visualization]\nimage: \"Screenshot.png\"\n---\n\n\n## Introduction\n\nThe dataset for this Tidy Tuesday is about Collegiate Sports in US. Alex Trinidad explores how revenue and expenditure are distributed in sports. He also looks at the differences in sport revenues and expenditures between men and women.\\`He presented this on May 3th 2022 in the NSC-R Tidy Tuesday serie. [Here](https://nscrweb.netlify.app/posts/2022-05-03-nsc-r-tidy-tuesday/) you can find the original post (Trinidad, 2022).\n\n## Load packages and importing data\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidytuesdayR)\nlibrary(tidyverse)\n```\n:::\n\n\nIdentify TidyTuesday data sets in 2022.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntidytuesdayR::tt_datasets(\"2022\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n   Week       Date                                   Data\n1     1 2022-01-04         Bring your own data from 2022!\n2     2 2022-01-11                      Bee Colony losses\n3     3 2022-01-18                  Chocolate Bar ratings\n4     4 2022-01-25                            Board games\n5     5 2022-02-01                             Dog breeds\n6     6 2022-02-08                        Tuskegee Airmen\n7     7 2022-02-15                   #DuBoisChallenge2022\n8     8 2022-02-22                    World Freedom index\n9     9 2022-03-01              Alternative Fuel Stations\n10   10 2022-03-08               Erasmus student mobility\n11   11 2022-03-15                    CRAN/BIOC Vignettes\n12   12 2022-03-22                             Baby names\n13   13 2022-03-29              Collegiate Sports Budgets\n14   14 2022-04-05                   Digital Publications\n15   15 2022-04-12                   Indoor Air Pollution\n16   16 2022-04-19            Crossword Puzzles and Clues\n17   17 2022-04-26                     Kaggle Hidden Gems\n18   18 2022-05-03                   Solar/Wind utilities\n19   19 2022-05-10                   NYTimes best sellers\n20   20 2022-05-17                             Eurovision\n21   21 2022-05-24                          Women's Rugby\n22   22 2022-05-31                Company reputation poll\n23   23 2022-06-07 Pride Corporate Accountability Project\n24   24 2022-06-14                             US Drought\n25   25 2022-06-21                             Juneteenth\n26   26 2022-06-28                      UK Gender pay gap\n27   27 2022-07-05                  San Francisco Rentals\n28   28 2022-07-12                       European flights\n29   29 2022-07-19                    Technology Adoption\n30   30 2022-07-26                    Bring your own data\n31   31 2022-08-02                    Oregon Spotted Frog\n32   32 2022-08-09                          Ferris Wheels\n33   33 2022-08-16              Open Source Psychometrics\n34   34 2022-08-23                           CHIP dataset\n35   35 2022-08-30                            Pell Grants\n36   36 2022-09-06                          LEGO database\n37   37 2022-09-13                                Bigfoot\n38   38 2022-09-20                Hydro Wastewater plants\n39   39 2022-09-27                     Artists in the USA\n40   40 2022-10-04                  Product Hunt products\n41   41 2022-10-11                           Ravelry data\n42   42 2022-10-18               Stranger things dialogue\n43   43 2022-10-25                  Great British Bakeoff\n44   44 2022-11-01                          Horror Movies\n45   45 2022-11-08                         Radio Stations\n46   46 2022-11-15                       Web page metrics\n47   47 2022-11-22                             UK Museums\n48   48 2022-11-29                         FIFA World Cup\n49   49 2022-12-06                              Elevators\n50   50 2022-12-13             Monthly State Retail Sales\n51   51 2022-12-20              Weather Forecast Accuracy\n52   52 2022-12-27                    Star Trek Timelines\n                                              Source\n1                                                   \n2                                               USDA\n3                                   Flavors of Cacao\n4                                             Kaggle\n5                               American Kennel Club\n6  Commemorative Airforce (CAF) by way of the VA-TUG\n7                                     Anthony Starks\n8                               UN and Freedom House\n9                                             US DOT\n10                                    Data.Europa.eu\n11                              Robert Flight GitHub\n12                       US babynames &  nzbabynames\n13                 Equity in Athletics Data Analysis\n14                                     Project Oasis\n15                                OurWorldInData.org\n16                             Cryptics.georgeho.org\n17                                            Kaggle\n18                                      Berkeley Lab\n19                                       Post45 Data\n20                                        Eurovision\n21                       Women's Rugby - ScrumQueens\n22                             Axios and Harris Poll\n23                                 Data For Progress\n24                                       Drought.gov\n25                WEB DuBois style by Anthony Starks\n26                     gender-pay-gap.service.gov.uk\n27                                   Kate Pennington\n28                                       Eurocontrol\n29                                     data.nber.org\n30                                              None\n31                        usgs.gov spotted frog data\n32                                      ferriswheels\n33                 Open-Source Psychometrics Project\n34                                      CHIP Dataset\n35                              US Dept of Education\n36                                       rebrickable\n37                                        Data.World\n38                                Macedo et al, 2022\n39                                          arts.gov\n40                                    components.one\n41                                       ravelry.com\n42                                         8flix.com\n43                                       bakeoff pkg\n44                                The Movie Database\n45                                         Wikipedia\n46                                   httpArchive.org\n47                  MuseWeb by way of Data Is Plural\n48                             Kaggle FIFA World Cup\n49                                    Elevators data\n50      US Census Bureau Monthly State Retails Sales\n51                Weather Forecast  Capstone Project\n52                                     rtrek package\n                                                         Article\n1                                                               \n2                                                   Bee Informed\n3                                       Will Canniford on Kaggle\n4                                                Alyssa Goldberg\n5                                                            Vox\n6               Wikipedia & Air Force Historical Research Agency\n7                                             Nightingale by DVS\n8                                                  Freedom House\n9                                                            EIA\n10                                                      Wimdu.co\n11                                          Robert Flight GitHub\n12                            Emily Kothe's nzbabynames vignette\n13                                                           NPR\n14                                          Project Oasis Report\n15                                            OurWorldInData.org\n16                                          Towards Data Science\n17                                Kaggle - Notebooks of the Week\n18                                           Berkeley Lab report\n19        Finding Trends in NY Times Best Sellers - Kailey Smith\n20                                                 Tanya Shapiro\n21                                                   ScrumQueens\n22                                               The Harris Poll\n23                                             Data For Progress\n24                                            Drought.gov report\n25                        Isabella Benabaye's blog on Juneteenth\n26                                                    ons.gov.uk\n27                                               Matrix-Berkeley\n28                                                  ec.europa.eu\n29                                                 www.cgdev.org\n30                                                          None\n31                                 usgs.gov spotted-frog-article\n32                                                  ferriswheels\n33                                         Character Personality\n34                                                   arxiv paper\n35                                                pell R package\n36                                                   rebrickable\n37                                               Finding Bigfoot\n38                                               HydroWASTE v1.0\n39                                      Artists in the Workforce\n40                 The Gamer and the Nihilist by Andrew Thompson\n41                                           {ravelRy} R package\n42                               freeCodeCamp & 'stringr things'\n43 Data Visualization in the Tidyverse - The Great Tidy Plot Off\n44                                 Tanya Shapiro's Horror Movies\n45                         Visualizing the Geography of FM Radio\n46                                  DataWrapper & Data is Plural\n47                                          MuseWeb Key Findings\n48                                             Dataset Notebooks\n49                           Elevators data package and examples\n50               Interactive Visualization from US Census Bureau\n51                            Weather Forecast  Capstone Project\n52                                                 rtrek package\n```\n:::\n:::\n\n\nDownload data set. Note: As list.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nttdata <- tidytuesdayR::tt_load(x = 2022, week = 13)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tDownloading file 1 of 1: `sports.csv`\n```\n:::\n:::\n\n\nSelect data set of interest.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsportdt <- ttdata[[1]]\n```\n:::\n\n\nAlternative\n\n```         \nsportdt <- ttdata$sports\n```\n\n## Data Exploration\n\nExplore data set\n\n\n::: {.cell}\n\n```{.r .cell-code}\nglimpse(sportdt)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nRows: 132,327\nColumns: 28\n$ year                 <dbl> 2015, 2015, 2015, 2015, 2015, 2015, 2015, 2015, 2~\n$ unitid               <dbl> 100654, 100654, 100654, 100654, 100654, 100654, 1~\n$ institution_name     <chr> \"Alabama A & M University\", \"Alabama A & M Univer~\n$ city_txt             <chr> \"Normal\", \"Normal\", \"Normal\", \"Normal\", \"Normal\",~\n$ state_cd             <chr> \"AL\", \"AL\", \"AL\", \"AL\", \"AL\", \"AL\", \"AL\", \"AL\", \"~\n$ zip_text             <chr> \"35762\", \"35762\", \"35762\", \"35762\", \"35762\", \"357~\n$ classification_code  <dbl> 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 1, 1, 1, 1, 1, 1, 1~\n$ classification_name  <chr> \"NCAA Division I-FCS\", \"NCAA Division I-FCS\", \"NC~\n$ classification_other <chr> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N~\n$ ef_male_count        <dbl> 1923, 1923, 1923, 1923, 1923, 1923, 1923, 1923, 1~\n$ ef_female_count      <dbl> 2300, 2300, 2300, 2300, 2300, 2300, 2300, 2300, 2~\n$ ef_total_count       <dbl> 4223, 4223, 4223, 4223, 4223, 4223, 4223, 4223, 4~\n$ sector_cd            <dbl> 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1~\n$ sector_name          <chr> \"Public, 4-year or above\", \"Public, 4-year or abo~\n$ sportscode           <dbl> 1, 2, 3, 7, 8, 15, 16, 22, 26, 33, 1, 2, 3, 8, 12~\n$ partic_men           <dbl> 31, 19, 61, 99, 9, NA, NA, 7, NA, NA, 32, 13, NA,~\n$ partic_women         <dbl> NA, 16, 46, NA, NA, 21, 25, 10, 16, 9, NA, 20, 68~\n$ partic_coed_men      <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N~\n$ partic_coed_women    <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N~\n$ sum_partic_men       <dbl> 31, 19, 61, 99, 9, 0, 0, 7, 0, 0, 32, 13, 0, 10, ~\n$ sum_partic_women     <dbl> 0, 16, 46, 0, 0, 21, 25, 10, 16, 9, 0, 20, 68, 7,~\n$ rev_men              <dbl> 345592, 1211095, 183333, 2808949, 78270, NA, NA, ~\n$ rev_women            <dbl> NA, 748833, 315574, NA, NA, 410717, 298164, 13114~\n$ total_rev_menwomen   <dbl> 345592, 1959928, 498907, 2808949, 78270, 410717, ~\n$ exp_men              <dbl> 397818, 817868, 246949, 3059353, 83913, NA, NA, 9~\n$ exp_women            <dbl> NA, 742460, 251184, NA, NA, 432648, 340259, 11388~\n$ total_exp_menwomen   <dbl> 397818, 1560328, 498133, 3059353, 83913, 432648, ~\n$ sports               <chr> \"Baseball\", \"Basketball\", \"All Track Combined\", \"~\n```\n:::\n:::\n\n\nSelect variables of interest and define chr-variables as fct\n\n\n::: {.cell}\n\n```{.r .cell-code}\nttdt_selection <- sportdt %>% \n  dplyr::select(year, institution_name, classification_name, partic_men, partic_women,\n         ef_male_count, ef_female_count, ef_total_count, rev_men,\n         rev_women,total_rev_menwomen, exp_men, exp_women,\n         total_exp_menwomen, sports) %>% \n  mutate(year = as.factor(year),\n         institution_name = as.factor(institution_name),\n         classification_name = as.factor(classification_name),\n         sports = as.factor(sports),\n         total_par = partic_men + partic_women) \n```\n:::\n\n\nNow we can answer some questions:\n\n*How many years?*\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsum(table(unique(ttdt_selection$year)))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 5\n```\n:::\n:::\n\n\nOr:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsum(table(fct_unique(ttdt_selection$year)))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 5\n```\n:::\n:::\n\n\n*How many divisions?*\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsum(table(unique(ttdt_selection$classification_name)))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 19\n```\n:::\n:::\n\n\n*How may institutions?*\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsum(table(unique(ttdt_selection$institution_name)))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 2212\n```\n:::\n:::\n\n\n*How many sports?*\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsum(table(unique(ttdt_selection$sports)))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 38\n```\n:::\n:::\n\n\n*How many cases per wave?*\n\n\n::: {.cell}\n\n```{.r .cell-code}\nttdt_selection %>% \n  count(year)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 5 x 2\n  year      n\n  <fct> <int>\n1 2015  17345\n2 2016  17414\n3 2017  17628\n4 2018  17772\n5 2019  62168\n```\n:::\n:::\n\n\n*How many cases per sport?*\n\n\n::: {.cell}\n\n```{.r .cell-code}\nttdt_selection %>% \n  count(sports)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 38 x 2\n   sports                 n\n   <fct>              <int>\n 1 All Track Combined  4870\n 2 Archery             1557\n 3 Badminton           1554\n 4 Baseball            8644\n 5 Basketball         10000\n 6 Beach Volleyball    1988\n 7 Bowling             2176\n 8 Diving              1530\n 9 Equestrian          1799\n10 Fencing             1687\n# ... with 28 more rows\n```\n:::\n:::\n\n\n## Visualizations\n\nPlot measures per sport\n\n\n::: {.cell .caption-margin}\n\n```{.r .cell-code}\nggplot(data = ttdt_selection) +\n  geom_bar(mapping = aes(x = sports, color = sports))  +\n  theme(legend.position = \"none\")\n```\n\n::: {.cell-output-display}\n![Proportions in a bar chart](07_TT_202205_files/figure-html/measures_sport-1.png){width=576}\n:::\n:::\n\n\nPlot measures per sport (y axis)\n\n\n::: {.cell .caption-margin}\n\n```{.r .cell-code}\nggplot(data = ttdt_selection) + \n  geom_bar(mapping = aes(y = sports, color = sports))\n```\n\n::: {.cell-output-display}\n![Measures per sport](07_TT_202205_files/figure-html/measures_sportunordered-1.png){width=576}\n:::\n:::\n\n\nPlot measures per sport (y axis ordered infrequent).\n\n\n::: {.cell .caption-margin}\n\n```{.r .cell-code}\nggplot(data = ttdt_selection) + \n  geom_bar(mapping = aes(y = fct_infreq(sports), color = sports))\n```\n\n::: {.cell-output-display}\n![Measures per sport ordered infrequent](07_TT_202205_files/figure-html/measures_sportinfrequent-1.png){width=576}\n:::\n:::\n\n\nPlot measures per sport (y)\n\n\n::: {.cell .caption-margin}\n\n```{.r .cell-code}\nggplot(data = ttdt_selection) + \n  geom_bar(mapping = aes(y = fct_rev(fct_infreq(sports)), color = sports))\n```\n\n::: {.cell-output-display}\n![Measures per sport ordered 2](07_TT_202205_files/figure-html/measures_sportordered2-1.png){width=576}\n:::\n:::\n\n\nPlot measures per sport (y)\n\n\n::: {.cell .caption-margin}\n\n```{.r .cell-code}\nggplot(data = ttdt_selection) + \n  geom_bar(mapping = aes(y = fct_rev(fct_infreq(sports)), color = sports)) +\n  ylab(\"Sports\") \n```\n\n::: {.cell-output-display}\n![Measures per sport ordered 3](07_TT_202205_files/figure-html/measures_sportordered3-1.png){width=576}\n:::\n:::\n\n\nPlot measures per sport (per year)\n\n\n::: {.cell .caption-margin}\n\n```{.r .cell-code}\nggplot(data = ttdt_selection) + \n  geom_bar(mapping = aes(y = fct_rev(fct_infreq(sports)), color = sports)) +\n  ylab(\"Sports\") +\n  facet_wrap(vars(year)) +\n  theme(legend.position = \"none\")\n```\n\n::: {.cell-output-display}\n![Measures per sport via facet wrap](07_TT_202205_files/figure-html/measures_sportwrap-1.png){width=576}\n:::\n:::\n\n\n## Missing data\n\nIs any NA in any of my variables?\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(ttdt_selection)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n   year                  institution_name \n 2015:17345   Westminster College:   238  \n 2016:17414   Union College      :   233  \n 2017:17628   Columbia College   :   187  \n 2018:17772   Bethel University  :   181  \n 2019:62168   Marian University  :   166  \n              Emmanuel College   :   162  \n              (Other)            :131160  \n                         classification_name   partic_men      partic_women   \n NCAA Division III with football   :18835    Min.   :  1.00   Min.   :  1.00  \n NCAA Division III without football:12310    1st Qu.: 13.00   1st Qu.: 11.00  \n NJCAA Division I                  :11831    Median : 22.00   Median : 16.00  \n NCAA Division II with football    :11535    Mean   : 30.86   Mean   : 20.71  \n NCAA Division I-FBS               :10052    3rd Qu.: 35.00   3rd Qu.: 23.00  \n NCAA Division II without football : 9571    Max.   :331.00   Max.   :327.00  \n (Other)                           :58193    NA's   :70462    NA's   :63442   \n ef_male_count   ef_female_count ef_total_count     rev_men         \n Min.   :    0   Min.   :    0   Min.   :    0   Min.   :       65  \n 1st Qu.:  513   1st Qu.:  652   1st Qu.: 1194   1st Qu.:    63428  \n Median :  986   Median : 1248   Median : 2259   Median :   158126  \n Mean   : 2126   Mean   : 2496   Mean   : 4622   Mean   :   809011  \n 3rd Qu.: 2385   3rd Qu.: 2860   3rd Qu.: 5237   3rd Qu.:   400604  \n Max.   :35954   Max.   :30325   Max.   :66279   Max.   :156147208  \n                                                 NA's   :70462      \n   rev_women        total_rev_menwomen     exp_men           exp_women      \n Min.   :       0   Min.   :      130   Min.   :      65   Min.   :     65  \n 1st Qu.:   58746   1st Qu.:    96299   1st Qu.:   63062   1st Qu.:  59301  \n Median :  138318   Median :   228776   Median :  159666   Median : 141800  \n Mean   :  279346   Mean   :   795231   Mean   :  662386   Mean   : 331594  \n 3rd Qu.:  331120   3rd Qu.:   541876   3rd Qu.:  424025   3rd Qu.: 361860  \n Max.   :21440365   Max.   :156147208   Max.   :69718059   Max.   :9485162  \n NA's   :63444      NA's   :45193       NA's   :70462      NA's   :63442    \n total_exp_menwomen        sports        total_par     \n Min.   :     130   Basketball:10000   Min.   :  2.00  \n 1st Qu.:   96436   Volleyball: 9122   1st Qu.: 22.00  \n Median :  234559   Soccer    : 8647   Median : 32.00  \n Mean   :  732422   Baseball  : 8644   Mean   : 45.66  \n 3rd Qu.:  585604   Softball  : 8560   3rd Qu.: 53.00  \n Max.   :69718059   Golf      : 7060   Max.   :617.00  \n NA's   :45191      (Other)   :80294   NA's   :88713   \n```\n:::\n:::\n\n\nRemove NAs from revenues in men and women.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmyselection <- ttdt_selection %>% \n  filter(!rev_men %in% NA & !rev_women %in% NA)\n```\n:::\n\n\nCheck if NA's in `myselection` dataset.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(myselection)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n   year                 institution_name\n 2015:8559   Westminster College:  103  \n 2016:8628   Bethel University  :   84  \n 2017:8767   Union College      :   84  \n 2018:8880   Emmanuel College   :   79  \n 2019:8780   Harvard University :   75  \n             Marian University  :   73  \n             (Other)            :43116  \n                         classification_name   partic_men      partic_women   \n NCAA Division III with football   : 8268    Min.   :  1.00   Min.   :  1.00  \n NCAA Division III without football: 5186    1st Qu.: 11.00   1st Qu.: 10.00  \n NCAA Division II without football : 3575    Median : 17.00   Median : 15.00  \n NCAA Division II with football    : 3415    Mean   : 24.18   Mean   : 21.48  \n NAIA Division II                  : 3313    3rd Qu.: 28.00   3rd Qu.: 25.00  \n NCAA Division I-FCS               : 3048    Max.   :290.00   Max.   :327.00  \n (Other)                           :16809                                     \n ef_male_count   ef_female_count ef_total_count     rev_men        \n Min.   :    0   Min.   :    0   Min.   :    0   Min.   :      65  \n 1st Qu.:  546   1st Qu.:  684   1st Qu.: 1268   1st Qu.:   55012  \n Median : 1004   Median : 1272   Median : 2284   Median :  131951  \n Mean   : 2140   Mean   : 2493   Mean   : 4633   Mean   :  405014  \n 3rd Qu.: 2393   3rd Qu.: 2830   3rd Qu.: 5237   3rd Qu.:  309113  \n Max.   :35954   Max.   :30325   Max.   :66279   Max.   :45632816  \n                                                                   \n   rev_women        total_rev_menwomen    exp_men           exp_women      \n Min.   :       0   Min.   :     130   Min.   :      65   Min.   :     65  \n 1st Qu.:   51180   1st Qu.:  108178   1st Qu.:   54786   1st Qu.:  51228  \n Median :  122982   Median :  259386   Median :  134146   Median : 125092  \n Mean   :  269807   Mean   :  674821   Mean   :  392666   Mean   : 319436  \n 3rd Qu.:  299104   3rd Qu.:  618145   3rd Qu.:  331960   3rd Qu.: 323727  \n Max.   :21440365   Max.   :48559421   Max.   :22178473   Max.   :9485162  \n                                                                           \n total_exp_menwomen                        sports        total_par     \n Min.   :     130   Basketball                : 9448   Min.   :  2.00  \n 1st Qu.:  107800   Soccer                    : 6657   1st Qu.: 22.00  \n Median :  261562   Tennis                    : 4628   Median : 32.00  \n Mean   :  712101   Golf                      : 4258   Mean   : 45.66  \n 3rd Qu.:  659871   All Track Combined        : 3604   3rd Qu.: 53.00  \n Max.   :28847845   Track and Field, X-Country: 3442   Max.   :617.00  \n                    (Other)                   :11577                   \n```\n:::\n:::\n\n\nAlternative way\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntable(is.na(myselection))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n FALSE \n697824 \n```\n:::\n:::\n\n\n## Revenues and expenditures\n\nCalculate revenues and expenditure per participant and add new variables.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmyselection <- myselection %>% \n  mutate(exp_per_men = exp_men / partic_men,\n         exp_per_women = exp_women / partic_women,\n         exp_per_total = total_exp_menwomen / total_par, \n         rev_per_men = rev_men / partic_men,\n         rev_per_women = rev_women / partic_women,\n         rev_per_total = total_rev_menwomen / total_par)\n```\n:::\n\n\n**Revenues**\n\nNow look at revenue in sports (Mean revenues per sport). This will not work.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nrev_mean <- myselection %>% \n  group_by(sports) %>% \n  summarise(mean_rev_total = mean(total_rev_menwomen)) %>% \n      ggplot(aes(x = mean_rev_total, y = sports, color = sports)) +\n      geom_bar() +\n      labs(x = \"Mean Revenues\", y = \"Sports\") \n```\n:::\n\n\n**Get rid of scientific notation**\n\n\n::: {.cell}\n\n```{.r .cell-code}\noptions(scipen = 999)\n```\n:::\n\n\nOr activate scientific notation\n\n\n::: {.cell}\n\n```{.r .cell-code}\noptions(scipen = 0)\n```\n:::\n\n\nSolution change to stat = \"identity\" in geom_bar()\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmyselection %>% \n  group_by(sports) %>% \n  summarise(mean_rev_total = mean(total_rev_menwomen)) %>% \n  ggplot(aes(x = mean_rev_total, y = sports, color = sports)) +\n  geom_bar(stat = \"identity\") +\n  labs(x = \"Mean Revenues\", y = \"Sports\") \n```\n\n::: {.cell-output-display}\n![](07_TT_202205_files/figure-html/unnamed-chunk-28-1.png){width=672}\n:::\n:::\n\n\nOrdering bars now\n\n\n::: {.cell .caption-margin}\n\n```{.r .cell-code}\nmyselection %>% \n  group_by(sports) %>% \n  summarise(mean_rev_total = mean(total_rev_menwomen)) %>% \n  ggplot(aes(x = mean_rev_total, y = fct_rev(fct_infreq(sports)), color = sports)) +\n  geom_bar(stat = \"identity\") +\n  labs(x = \"Mean Revenues\", y = \"Sports\") \n```\n\n::: {.cell-output-display}\n![Revenues per sport ordered](07_TT_202205_files/figure-html/revenues_sportordered-1.png){width=576}\n:::\n:::\n\n\nBars reordered.\n\n\n::: {.cell .caption-margin}\n\n```{.r .cell-code}\nmyselection %>% \n  group_by(year, sports) %>% \n  summarise(mean_rev_total = mean(total_rev_menwomen)) %>% \n  ggplot(aes(x = mean_rev_total, y = reorder(sports, mean_rev_total),\n             color = sports)) +\n  geom_bar(stat = \"identity\") +\n  labs(x = \"Mean Revenues\", y = \"Sports\") + \n  theme(legend.position = \"none\") + \n  facet_wrap(vars(year))\n```\n\n::: {.cell-output-display}\n![Revenues per sport bars reordered](07_TT_202205_files/figure-html/revenues_sportbarsreordered-1.png){width=576}\n:::\n:::\n\n\nPlot mean revenues per sport and sex.\n\n\n::: {.cell .caption-margin}\n\n```{.r .cell-code}\nmyselection %>% \n  group_by(sports) %>% \n  summarise(mean_rev_men = mean(rev_men),\n            mean_rev_women = mean(rev_women)) %>% \n  pivot_longer(cols = c(mean_rev_men,mean_rev_women), names_to = \"sex\",\n               values_to = \"mean_rev\") %>% \n  ggplot(aes(x = mean_rev, y = reorder(sports, mean_rev), fill = sex)) +\n  geom_bar(stat = \"identity\") +\n  labs(x = \"Mean Revenues\", y = \"Sports\", fill = \"Sex\") +\n  scale_fill_discrete(labels = c(\"Men\", \"Women\"))\n```\n\n::: {.cell-output-display}\n![Revenues per sport and sex](07_TT_202205_files/figure-html/revenues_sportsex-1.png){width=576}\n:::\n:::\n\n::: {.cell .caption-margin}\n\n```{.r .cell-code}\nmyselection %>% \n  group_by(sports) %>% \n  summarise(mean_rev_men = mean(rev_men),\n            mean_rev_women = mean(rev_women)) %>% \n  mutate(mean_dif = sqrt((mean_rev_men - mean_rev_women) ^ 2)) %>% \n  ggplot(aes(x = mean_dif, y = reorder(sports, mean_dif), fill = mean_dif)) +\n  geom_bar(stat = \"identity\") +\n  # facet_wrap(vars(year)) +\n  labs(x = \"Mean Sex Differences in Revenues (USD)\",  y = \"Sports\", fill = \"USD\")  \n```\n\n::: {.cell-output-display}\n![Mean sex differences in revenues (USD)](07_TT_202205_files/figure-html/mean_diff-1.png){width=576}\n:::\n:::\n\n\n**Expenditures in Sport**\n\nPlot mean expenditure\n\n\n::: {.cell .caption-margin}\n\n```{.r .cell-code}\nmyselection %>% \n  group_by(sports) %>% \n  summarise(mean_exp_men = mean(exp_men),\n            mean_exp_women = mean(exp_women)) %>% \n  pivot_longer(cols = c(mean_exp_men,mean_exp_women), names_to = \"sex\",\n               values_to = \"mean_exp\") %>% \n  ggplot(aes(x = mean_exp, y = reorder(sports, mean_exp), fill = sex)) +\n  geom_bar(stat = \"identity\") +\n  labs(x = \"Mean Expenditure\", y = \"Sports\", fill = \"Sex\") +\n  scale_fill_discrete(labels = c(\"Men\", \"Women\"))\n```\n\n::: {.cell-output-display}\n![Expenditures in sport](07_TT_202205_files/figure-html/exp_sport-1.png){width=576}\n:::\n:::\n\n\nPlotting mean differences by sex.\n\n\n::: {.cell .caption-margin}\n\n```{.r .cell-code}\nmyselection %>% \n  group_by(sports) %>% # if facet_wrap, add year\n  summarise(mean_exp_men = mean(exp_men),\n            mean_exp_women = mean(exp_women)) %>% \n  mutate(mean_dif = sqrt((mean_exp_men - mean_exp_women) ^ 2)) %>% \n  ggplot(aes(x = mean_dif, y = reorder(sports, mean_dif), fill = mean_dif)) +\n  geom_bar(stat = \"identity\") +\n  # facet_wrap(vars(year)) +\n  labs(x = \"Mean Sex Differences (USD)\",  y = \"Sports\", fill = \"USD\")  \n```\n\n::: {.cell-output-display}\n![Mean differences by sex](07_TT_202205_files/figure-html/meandif_sex-1.png){width=576}\n:::\n:::\n\n\nIf necessary install RColorBrewer package\n\n```         \n# install.packages(RColorBrewer) \n```\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(RColorBrewer)\n```\n:::\n\n\nSet palettes (display.brewer.all())\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndiscrete_palettes <- list(\n  c(\"orange\", \"skyblue\"),\n  RColorBrewer::brewer.pal(6, \"Accent\"),\n  RColorBrewer::brewer.pal(3, \"Set2\")\n)\n```\n:::\n\n\nCalculate mean expenditure per participant & plot.\n\n\n::: {.cell .caption-margin}\n\n```{.r .cell-code}\nmyselection %>% \n  group_by(sports) %>% \n  summarise(mean_exp_pamen = mean(exp_per_men),\n            mean_exp_pawomen = mean(exp_per_women)) %>%  \n  pivot_longer(cols = c(mean_exp_pamen,mean_exp_pawomen), names_to = \"sex\",\n               values_to = \"mean_exp_pa\") %>% \n  ggplot(aes(x = mean_exp_pa, y = reorder(sports, mean_exp_pa), fill = sex)) +\n  geom_bar(stat = \"identity\") +\n  labs(x = \"Year and Institution Mean Expenditure per Participant\",\n       y = \"Sports\", fill = \"Sex\") +\n  scale_fill_discrete(labels = c(\"Men\", \"Women\"), type = discrete_palettes)\n```\n\n::: {.cell-output-display}\n![Year and institution mean expenditure per participant](07_TT_202205_files/figure-html/meanexp_participant-1.png){width=576}\n:::\n:::\n\n\nCalculate mean expenditure per participant differences and plot\n\n\n::: {.cell .caption-margin}\n\n```{.r .cell-code}\nmyselection %>% \n  group_by(sports) %>% \n  summarise(mean_exp_pamen = mean(exp_per_men),\n            mean_exp_pawomen = mean(exp_per_women)) %>% \n  mutate(mean_pa_dif = sqrt((mean_exp_pamen - mean_exp_pawomen) ^ 2)) %>% \n  ggplot(aes(x = mean_pa_dif, y = reorder(sports, mean_pa_dif), \n             fill = mean_pa_dif)) +\n  geom_bar(stat = \"identity\") +\n  # facet_wrap(vars(year)) +\n  labs(x = \"Mean Sex Differences Expenditures per Participant (USD)\", \n       y = \"Sports\", fill = \"USD\") +\n  scale_fill_continuous( type = \"viridis\")\n```\n\n::: {.cell-output-display}\n![Mean Sex Differences Expenditures per Participant (USD)](07_TT_202205_files/figure-html/meandifsex_participant-1.png){width=576}\n:::\n:::\n\n\nCompare plots with means: Expenditure \"Gross\" & per participant\n\n\n::: {.cell .caption-margin}\n\n```{.r .cell-code}\nplotmeanexp <- myselection %>% \n  group_by(sports) %>% \n  summarise(mean_exp_men = mean(exp_men),\n            mean_exp_women = mean(exp_women)) %>% \n  pivot_longer(cols = c(mean_exp_men,mean_exp_women), names_to = \"sex\",\n               values_to = \"mean_exp\") %>% \n  ggplot(aes(x = mean_exp, y = reorder(sports, mean_exp), fill = sex)) +\n  geom_bar(stat = \"identity\") +\n  labs(x = \"Year and Institution Mean Expenditure\", y = \"Sports\", fill = \"Sex\") +\n  scale_fill_discrete(labels = c(\"Men\", \"Women\"))\nplotmeanexp\n```\n\n::: {.cell-output-display}\n![Year and Institution Mean Expenditure](07_TT_202205_files/figure-html/sports_sex-1.png){width=576}\n:::\n:::\n\n::: {.cell .caption-margin}\n\n```{.r .cell-code}\nplotmeanexp_pa <- myselection %>% \n  group_by(sports) %>% \n  summarise(mean_exp_pamen = mean(exp_per_men),\n            mean_exp_pawomen = mean(exp_per_women)) %>%  \n  pivot_longer(cols = c(mean_exp_pamen,mean_exp_pawomen), names_to = \"sex\",\n               values_to = \"mean_exp_pa\") %>% \n  ggplot(aes(x = mean_exp_pa, y = reorder(sports, mean_exp_pa), fill = sex)) +\n  geom_bar(stat = \"identity\") +\n  labs(x = \"Year and Institution Mean Expenditure per Participant\",\n       y = \"Sports\", fill = \"Sex\") +\n  scale_fill_discrete(labels = c(\"Men\", \"Women\"), type = discrete_palettes)\nplotmeanexp_pa\n```\n\n::: {.cell-output-display}\n![Year and Institution Mean Expenditure per Participant](07_TT_202205_files/figure-html/sports_sexdiscrete-1.png){width=576}\n:::\n:::\n\n::: {.cell .caption-margin}\n\n```{.r .cell-code}\nplotmeandifexp <- myselection %>% \n  group_by(sports) %>% # if facet_wrap, add year\n  summarise(mean_exp_men = mean(exp_men),\n            mean_exp_women = mean(exp_women)) %>% \n  mutate(mean_dif = sqrt((mean_exp_men - mean_exp_women) ^ 2)) %>% \n  ggplot(aes(x = mean_dif, y = reorder(sports, mean_dif), fill = mean_dif)) +\n  geom_bar(stat = \"identity\") +\n  # facet_wrap(vars(year)) +\n  labs(x = \"Mean Sex Differences in Expenditures (USD)\",  y = \"Sports\", fill = \"USD\")\nplotmeandifexp\n```\n\n::: {.cell-output-display}\n![Mean Sex Differences in Expenditures](07_TT_202205_files/figure-html/meansexdif_expenditures-1.png){width=576}\n:::\n:::\n\n::: {.cell .caption-margin}\n\n```{.r .cell-code}\nplotmeandifexp_pa <- myselection %>% \n  group_by(sports) %>% \n  summarise(mean_exp_pamen = mean(exp_per_men),\n            mean_exp_pawomen = mean(exp_per_women)) %>% \n  mutate(mean_pa_dif = sqrt((mean_exp_pamen - mean_exp_pawomen) ^ 2)) %>% \n  ggplot(aes(x = mean_pa_dif, y = reorder(sports, mean_pa_dif), \n             fill = mean_pa_dif)) +\n  geom_bar(stat = \"identity\") +\n  # facet_wrap(vars(year)) +\n  labs(x = \"Mean Sex Differences Expenditures per Participant (USD)\", \n       y = \"Sports\", fill = \"USD\") +\n  scale_fill_continuous( type = \"viridis\")\n```\n:::\n\n\nIf necessary install package\n\n```         \ninstall.packages(\"gridExtra\")\n```\n\nLoad package\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(gridExtra)\n```\n:::\n\n\nPlots together to compare\n\n\n::: {.cell .caption-margin}\n\n```{.r .cell-code}\ngridExtra::grid.arrange(plotmeanexp, plotmeanexp_pa)\n```\n\n::: {.cell-output-display}\n![Comparing plots](07_TT_202205_files/figure-html/plots_together-1.png){width=576}\n:::\n\n```{.r .cell-code}\ngridExtra::grid.arrange(plotmeandifexp, plotmeandifexp_pa)\n```\n\n::: {.cell-output-display}\n![Comparing plots](07_TT_202205_files/figure-html/plots_together-2.png){width=576}\n:::\n:::\n\n\n**Relationship between expenditure and revenue**\n\n\n::: {.cell .caption-margin}\n\n```{.r .cell-code}\nplotmeandifexp_pa <- myselection %>% \n  group_by(sports) %>% \n  summarise(mean_exp_pamen = mean(exp_per_men),\n            mean_exp_pawomen = mean(exp_per_women)) %>% \n  mutate(mean_pa_dif = sqrt((mean_exp_pamen - mean_exp_pawomen) ^ 2)) %>% \n  ggplot(aes(x = mean_pa_dif, y = reorder(sports, mean_pa_dif), \n             fill = mean_pa_dif)) +\n  geom_bar(stat = \"identity\") +\n  # facet_wrap(vars(year)) +\n  labs(x = \"Mean Sex Differences Expenditures per Participant (USD)\", \n       y = \"Sports\", fill = \"USD\") +\n  scale_fill_continuous( type = \"viridis\")\n```\n:::\n\n::: {.cell .caption-margin}\n\n```{.r .cell-code}\nplotmeandifrev_pa <- myselection %>% \n  group_by(sports) %>% \n  summarise(mean_rev_pamen = mean(rev_per_men),\n            mean_rev_pawomen = mean(rev_per_women)) %>% \n  mutate(mean_parev_dif = sqrt((mean_rev_pamen - mean_rev_pawomen) ^ 2)) %>% \n  ggplot(aes(x = mean_parev_dif, y = reorder(sports, mean_parev_dif), \n             fill = mean_parev_dif)) +\n  geom_bar(stat = \"identity\") +\n  # facet_wrap(vars(year)) +\n  labs(x = \"Mean Sex Differences Revenues per Participant (USD)\", \n       y = \"Sports\", fill = \"USD\") \n```\n:::\n\n\nGrid plot\n\n\n::: {.cell .caption-margin}\n\n```{.r .cell-code}\ngridExtra::grid.arrange(plotmeandifrev_pa, plotmeandifexp_pa)\n```\n\n::: {.cell-output-display}\n![Grid plots compare](07_TT_202205_files/figure-html/grid_plot-1.png){width=576}\n:::\n:::\n\n\nCorrelation between Expenditures and Revenues\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncor(myselection$exp_men, myselection$rev_men, method = \"spearman\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.9642041\n```\n:::\n:::\n\n\nCorrelation between exp. and rev. per sport.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmyselection %>% \n  group_by(sports) %>%\n  summarise(assoc_exp_rev_men = cor(exp_men, rev_men, method = \"spearman\"))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 31 x 2\n   sports             assoc_exp_rev_men\n   <fct>                          <dbl>\n 1 All Track Combined            0.855 \n 2 Archery                       0.991 \n 3 Basketball                    0.996 \n 4 Beach Volleyball              0.987 \n 5 Bowling                       0.996 \n 6 Diving                        0.531 \n 7 Equestrian                    0.5   \n 8 Fencing                       0.696 \n 9 Golf                          0.914 \n10 Gymnastics                    0.0757\n# ... with 21 more rows\n```\n:::\n:::\n\n\nPlot association\n\n\n::: {.cell .caption-margin}\n\n```{.r .cell-code}\nmyselection %>% \n  group_by(sports) %>%\n  ggplot(mapping = aes(x = exp_men, y = rev_men)) +\n  geom_point(alpha = 0.5) +\n  geom_smooth(method = \"lm\", se = FALSE, color = \"blue\") +\n  labs(x = \"Men Expenditure\", \n       y = \"Men Revenue\", fill = \"USD\") +\n  facet_wrap(vars(sports), scales = \"free_y\")\n```\n\n::: {.cell-output-display}\n![Plot association](07_TT_202205_files/figure-html/plot_association-1.png){width=576}\n:::\n:::\n\n::: {.cell .caption-margin}\n\n```{.r .cell-code}\nmyselection %>% \n  group_by(sports) %>%\n  ggplot(mapping = aes(x = exp_women, y = rev_women)) +\n  geom_point(alpha = 0.5) +\n  geom_smooth(method = \"lm\", se = FALSE, color = \"red\") +\n  labs(x = \"Women Expenditure\", \n       y = \"Women Revenue\", fill = \"USD\") +\n  facet_wrap(vars(sports), scales = \"free_y\")\n```\n\n::: {.cell-output-display}\n![Relationship woman expenditure and revenue](07_TT_202205_files/figure-html/women_exprev-1.png){width=576}\n:::\n:::\n\n\n## References\n\nTrinidad, A. (2022, April). *NSC-R Workshops: NSC-R Tidy Tuesday. NSCR*. Retrieved from https://nscrweb.netlify.app/posts/2022-02-22-nsc-r-tidy-tuesday\n",
    "supporting": [
      "07_TT_202205_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}