{
  "hash": "69fa8f1d8dde9f5a73bbecfe15afb180",
  "result": {
    "markdown": "---\ntitle: \"Research of Board Games\"\nauthor: \"Asier Morevan\"\ndate: \"2022-02-08\"\ncategories: [exploration, visualization]\nimage: \"Screenshot1.png\"\n---\n\n\n## Introduction\n\nThe dataset for this Tidy Tuesday is about board games! Asier Moneva explores the following research questions: \"What are the top 3 best-selling board games by game type?\" and \"How do board game sales relate to online user ratings?\"[@moneva_nsc-r_2022]\n\n## Load packages\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(dplyr)\nlibrary(ggplot2)\n```\n:::\n\n\nToday's data are relational, which means there are multiple datasets (`rating`, `details`) that can be linked through some identifier or `id` variable or 'key'.\n\n## Import data\n\n\n::: {.cell}\n\n```{.r .cell-code}\nratings <- readr::read_csv(\"https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2022/2022-01-25/ratings.csv\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndetails <- readr::read_csv(\"https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2022/2022-01-25/details.csv\")\n```\n:::\n\n\n## Explore data\n\nSo let's have a quick look at the data.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nglimpse(ratings)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nRows: 21,831\nColumns: 10\n$ num           <dbl> 105, 189, 428, 72, 103, 191, 100, 3, 15, 35, 30, 182, 13~\n$ id            <dbl> 30549, 822, 13, 68448, 36218, 9209, 178900, 167791, 1733~\n$ name          <chr> \"Pandemic\", \"Carcassonne\", \"Catan\", \"7 Wonders\", \"Domini~\n$ year          <dbl> 2008, 2000, 1995, 2010, 2008, 2004, 2015, 2016, 2015, 20~\n$ rank          <dbl> 106, 190, 429, 73, 104, 192, 101, 4, 16, 36, 31, 183, 14~\n$ average       <dbl> 7.59, 7.42, 7.14, 7.74, 7.61, 7.41, 7.60, 8.42, 8.11, 7.~\n$ bayes_average <dbl> 7.487, 7.309, 6.970, 7.634, 7.499, 7.305, 7.508, 8.274, ~\n$ users_rated   <dbl> 108975, 108738, 108024, 89982, 81561, 76171, 74419, 7421~\n$ url           <chr> \"/boardgame/30549/pandemic\", \"/boardgame/822/carcassonne~\n$ thumbnail     <chr> \"https://cf.geekdo-images.com/S3ybV1LAp-8SnHIXLLjVqA__mi~\n```\n:::\n\n```{.r .cell-code}\nglimpse(details)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nRows: 21,631\nColumns: 23\n$ num                     <dbl> 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, ~\n$ id                      <dbl> 30549, 822, 13, 68448, 36218, 9209, 178900, 16~\n$ primary                 <chr> \"Pandemic\", \"Carcassonne\", \"Catan\", \"7 Wonders~\n$ description             <chr> \"In Pandemic, several virulent diseases have b~\n$ yearpublished           <dbl> 2008, 2000, 1995, 2010, 2008, 2004, 2015, 2016~\n$ minplayers              <dbl> 2, 2, 3, 2, 2, 2, 2, 1, 2, 1, 3, 2, 1, 2, 2, 2~\n$ maxplayers              <dbl> 4, 5, 4, 7, 4, 5, 8, 5, 2, 5, 5, 4, 5, 5, 5, 4~\n$ playingtime             <dbl> 45, 45, 120, 30, 30, 60, 15, 120, 30, 150, 150~\n$ minplaytime             <dbl> 45, 30, 60, 30, 30, 30, 15, 120, 30, 30, 90, 3~\n$ maxplaytime             <dbl> 45, 45, 120, 30, 30, 60, 15, 120, 30, 150, 150~\n$ minage                  <dbl> 8, 7, 10, 10, 13, 8, 14, 12, 10, 12, 12, 10, 1~\n$ boardgamecategory       <chr> \"['Medical']\", \"['City Building', 'Medieval', ~\n$ boardgamemechanic       <chr> \"['Action Points', 'Cooperative Game', 'Hand M~\n$ boardgamefamily         <chr> \"['Components: Map (Global Scale)', 'Component~\n$ boardgameexpansion      <chr> \"['Pandemic: Gen Con 2016 Promos – Z-Force Tea~\n$ boardgameimplementation <chr> \"['Pandemic Legacy: Season 0', 'Pandemic Legac~\n$ boardgamedesigner       <chr> \"['Matt Leacock']\", \"['Klaus-Jürgen Wrede']\", ~\n$ boardgameartist         <chr> \"['Josh Cappel', 'Christian Hanisch', 'Régis M~\n$ boardgamepublisher      <chr> \"['Z-Man Games', 'Albi', 'Asmodee', 'Asmodee I~\n$ owned                   <dbl> 168364, 161299, 167733, 120466, 106956, 105748~\n$ trading                 <dbl> 2508, 1716, 2018, 1567, 2009, 930, 1110, 538, ~\n$ wanting                 <dbl> 625, 582, 485, 1010, 655, 692, 340, 2011, 924,~\n$ wishing                 <dbl> 9344, 7383, 5890, 12105, 8621, 6620, 5764, 192~\n```\n:::\n:::\n\n\nYou see that the number of observations do not match!\n\nExplore whether both datasets have identical `id`\n\n\n::: {.cell}\n\n```{.r .cell-code}\nidentical(details$id, ratings$id)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] FALSE\n```\n:::\n:::\n\n\nCount how many `id` are missing.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntable(ratings$id %in% details$id)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nFALSE  TRUE \n  200 21631 \n```\n:::\n:::\n\n\nFind which `id` are present in both datasets. Results not show here because of too long output.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nintersect(details$id, ratings$id)\n```\n:::\n\n\nFind which `id` are absent in the dataset with the least observations\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsetdiff(ratings$id, details$id)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n  [1] 298130 286790   2415  12369  25999 304051 262554  67499  16268 236881\n [11] 102750  15391  10889   4875 165190 225303  18536 192323 143663  18704\n [21]  33125 297139   7578  32922 143459 237088 311004 195158  12624 201917\n [31]  34403  18061   5043  15049  23733 225828   6913 176633 198541  64608\n [41]   3610  29268 244268 177566  38836 275284  10544 284617 191292  96626\n [51]   8741   7752 136856  12900  30335 189615 183344  36238  39663 314125\n [61] 325678 246310 109827  19475  31412  69233   5649  98978   3814 140973\n [71] 265039  39278 188968 144378 303676  20533  13094   9860 310880 304666\n [81] 279649  40804   8249 245060 246895  10246  14698 172088   6124  20647\n [91] 264654 299690 147457  23616 258761 311990 132616 154841   8356 216360\n[101]  12169 226237 118561  49050 282410   2493   9398   9578   9512  24079\n[111]   3398 147616   7368 170390  36993  23999 316090  11674   9454  34129\n[121] 252901  10105 287304 164428  41611 232874   1550 252373   3909 145206\n[131]  36366 308870  24857 210350   6839 125585   9113 145400 239523  16830\n[141]  19304  40886  21437 328866 244528 252374  17996  22354 283849  14128\n[151] 305270 237834 137366  38524   3338   1221 319593   3830 102150  10154\n[161] 208800 214486  32324  86443 162888 221208 241611  17433   9736  18687\n[171] 104770   8426 247135 233284  11421  13918  31585   2103 210292 276641\n[181] 289055  15427  24994  47475  66276 205156   3047   8700 306072  14377\n[191]   1191 251026  19044 282389 296644 284839 144874 179124 150429  35499\n```\n:::\n:::\n\n\nMerge data\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndf <- inner_join(ratings, details, by = \"id\")\n```\n:::\n\n\nExplore data\n\n\n::: {.cell}\n\n```{.r .cell-code}\nglimpse(df)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nRows: 21,631\nColumns: 32\n$ num.x                   <dbl> 105, 189, 428, 72, 103, 191, 100, 3, 15, 35, 3~\n$ id                      <dbl> 30549, 822, 13, 68448, 36218, 9209, 178900, 16~\n$ name                    <chr> \"Pandemic\", \"Carcassonne\", \"Catan\", \"7 Wonders~\n$ year                    <dbl> 2008, 2000, 1995, 2010, 2008, 2004, 2015, 2016~\n$ rank                    <dbl> 106, 190, 429, 73, 104, 192, 101, 4, 16, 36, 3~\n$ average                 <dbl> 7.59, 7.42, 7.14, 7.74, 7.61, 7.41, 7.60, 8.42~\n$ bayes_average           <dbl> 7.487, 7.309, 6.970, 7.634, 7.499, 7.305, 7.50~\n$ users_rated             <dbl> 108975, 108738, 108024, 89982, 81561, 76171, 7~\n$ url                     <chr> \"/boardgame/30549/pandemic\", \"/boardgame/822/c~\n$ thumbnail               <chr> \"https://cf.geekdo-images.com/S3ybV1LAp-8SnHIX~\n$ num.y                   <dbl> 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, ~\n$ primary                 <chr> \"Pandemic\", \"Carcassonne\", \"Catan\", \"7 Wonders~\n$ description             <chr> \"In Pandemic, several virulent diseases have b~\n$ yearpublished           <dbl> 2008, 2000, 1995, 2010, 2008, 2004, 2015, 2016~\n$ minplayers              <dbl> 2, 2, 3, 2, 2, 2, 2, 1, 2, 1, 3, 2, 1, 2, 2, 2~\n$ maxplayers              <dbl> 4, 5, 4, 7, 4, 5, 8, 5, 2, 5, 5, 4, 5, 5, 5, 4~\n$ playingtime             <dbl> 45, 45, 120, 30, 30, 60, 15, 120, 30, 150, 150~\n$ minplaytime             <dbl> 45, 30, 60, 30, 30, 30, 15, 120, 30, 30, 90, 3~\n$ maxplaytime             <dbl> 45, 45, 120, 30, 30, 60, 15, 120, 30, 150, 150~\n$ minage                  <dbl> 8, 7, 10, 10, 13, 8, 14, 12, 10, 12, 12, 10, 1~\n$ boardgamecategory       <chr> \"['Medical']\", \"['City Building', 'Medieval', ~\n$ boardgamemechanic       <chr> \"['Action Points', 'Cooperative Game', 'Hand M~\n$ boardgamefamily         <chr> \"['Components: Map (Global Scale)', 'Component~\n$ boardgameexpansion      <chr> \"['Pandemic: Gen Con 2016 Promos – Z-Force Tea~\n$ boardgameimplementation <chr> \"['Pandemic Legacy: Season 0', 'Pandemic Legac~\n$ boardgamedesigner       <chr> \"['Matt Leacock']\", \"['Klaus-Jürgen Wrede']\", ~\n$ boardgameartist         <chr> \"['Josh Cappel', 'Christian Hanisch', 'Régis M~\n$ boardgamepublisher      <chr> \"['Z-Man Games', 'Albi', 'Asmodee', 'Asmodee I~\n$ owned                   <dbl> 168364, 161299, 167733, 120466, 106956, 105748~\n$ trading                 <dbl> 2508, 1716, 2018, 1567, 2009, 930, 1110, 538, ~\n$ wanting                 <dbl> 625, 582, 485, 1010, 655, 692, 340, 2011, 924,~\n$ wishing                 <dbl> 9344, 7383, 5890, 12105, 8621, 6620, 5764, 192~\n```\n:::\n:::\n\n\nLooks like there are some duplicated variables!\n\nNot really\n\n\n::: {.cell}\n\n```{.r .cell-code}\nidentical(df$year, df$yearpublished)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] FALSE\n```\n:::\n:::\n\n\nWhat is the difference?\n\n\n::: {.cell}\n\n```{.r .cell-code}\nwhich(df$year != df$yearpublished)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n [1]   209   297   881  1030  2239  3623  4089  4723 15507 16494 21623\n```\n:::\n:::\n\n\nAh, I see!\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndf$year[21623]\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 3000\n```\n:::\n\n```{.r .cell-code}\ndf$yearpublished[21623]\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] -3000\n```\n:::\n:::\n\n\nNope. Very different. Can these be row numbers (e.g. spreadsheet)?\n\n\n::: {.cell}\n\n```{.r .cell-code}\nidentical(df$num.x, df$num.y)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] FALSE\n```\n:::\n:::\n\n\nAlmost, but nope.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nidentical(df$name, df$primary)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] FALSE\n```\n:::\n\n```{.r .cell-code}\nwhich(df$name != df$primary)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1]  7222 10903 12599 13233 19925\n```\n:::\n:::\n\n\nLooks like there is some sort of syntax issue in `primary`\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndf$name[19925]\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"Admiral Ackbar \\\"It's a TRAP!\\\" GAME\"\n```\n:::\n\n```{.r .cell-code}\ndf$primary[19925]\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"Admiral Ackbar \\\"It\\\\'s a TRAP!\\\" GAME\"\n```\n:::\n:::\n\n\nBingo!\n\n\n::: {.cell}\n\n```{.r .cell-code}\nidentical(df$playingtime, df$maxplaytime)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] TRUE\n```\n:::\n:::\n\n\nLet's drop the duplicated variable\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndf <- df %>% \n  select(\n    - playingtime,\n    - primary\n  )\n```\n:::\n\n\nLooks like we are good now! Imagine the following:\n\n-   We want to buy a board game for a friend, but we don't know which one to get.\n\n-   We know our friend likes to play alone with his girlfriend sometimes, but some Other times he likes to invite friends over to play.\n\n-   What are the top 3 best-selling board games by game type?\n\n-   How do board game sales relate to online user ratings?\n\n-   What are the top 3 best-selling board games by game type?\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndf <- df |> \n  # Create new variable to define type of game based on number of players\n  mutate(minplayers_fct = case_when(\n    minplayers < 2 ~ \"single player\",\n    minplayers == 2 ~ \"two players\",\n    minplayers > 2 ~ \"multiplayer\"\n  ))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndf |> \n  # Select only relevant variables\n  select(\n    name,\n    minplayers_fct,\n    owned\n  ) |> \n  group_by(minplayers_fct) |> \n  slice_max(owned, n = 3) |> \n  knitr::kable()\n```\n\n::: {.cell-output-display}\n|name              |minplayers_fct |  owned|\n|:-----------------|:--------------|------:|\n|Catan             |multiplayer    | 167733|\n|Munchkin          |multiplayer    |  78849|\n|Dixit             |multiplayer    |  76535|\n|Terraforming Mars |single player  | 101872|\n|Scythe            |single player  |  86371|\n|Wingspan          |single player  |  83920|\n|Pandemic          |two players    | 168364|\n|Carcassonne       |two players    | 161299|\n|7 Wonders         |two players    | 120466|\n:::\n:::\n\n\nWe have identified the best-sellers for each category, but best-sellers might be a product of marketing rather than an indicator of good quality. It might be the case that players buy the product because of good marketing but then find the game boring, too complicated, etc.\n\nHow do board game sales relate to online user ratings?\n\n## Plot data\n\n\n::: {.cell .caption-margin}\n\n```{.r .cell-code}\ndf %>% \n  ggplot(mapping = aes(\n    x = average,\n    y = owned,\n    # Examine if there are clear patterns by number of players\n    color = minplayers_fct\n  )) +\n  geom_point(alpha = .5) +\n  # There seems to be three outliers that are best-sellers and also have high \n  # ratings\n  ggrepel::geom_text_repel(\n    data = df |> filter(owned > 150000),\n    mapping = aes(label = name),\n    color = \"black\"\n    ) +\n  scale_x_continuous(limits = c(0, 10)) +\n  scale_color_viridis_d() +\n  labs(\n    title = \"How do board game sales relate to online user ratings?\",\n    x = \"average user rating\",\n    y = \"number of\\ncopies owned\",\n    color = \"Category\"\n  ) +\n  theme_classic() +\n  theme(axis.title.y = element_text(\n    angle = 0,\n    vjust = .5\n  ))\n```\n\n::: {.cell-output-display}\n![Relation board game sales and online user ratings](02_TT_202202_files/figure-html/patterns_players-1.png){width=576}\n:::\n:::\n\n\n## References\n",
    "supporting": [
      "02_TT_202202_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}